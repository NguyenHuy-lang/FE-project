<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Profile</title>
</head>

<body>
    <h1>Profile</h1>
</body>
<script>
    let params = {}
    let regex = /([^&=]+)=([^&]*)/g, m
    while (m = regex.exec(location.href)) {
        params[decodeURIComponent(m[1])] = decodeURIComponent(m[2])
    }

    if (Object.keys(params).length > 0) {
        localStorage.setItem('authInfo', JSON.stringify(params))
    }

    window.history.pushState({}, document.title, "/" + "profile.html")

    let info = JSON.parse(localStorage.getItem('authInfo'))

    console.log(info)
    console.log(info['access_token'])
    console.log(info['expires_in'])

    const accessToken = info['access_token'];
    const postData = { foo: 'bar' };
    const postOptions = {
        method: 'POST',
        headers: {
            'Authorization': `Bearer ${accessToken}`,
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(postData)
    };

    fetch('http://localhost:8080/api/v1/auth/authenticate', postOptions)
        .then(response => response.json())
        .then(data => console.log(data))
        .catch(error => console.error(error));


</script>

</html>